---
title: 使用微PE工具箱安装/重装windows系统
date: 2022-04-27 22:39:00
updated: 2022-04-27 22:39:00
tags:
categories: 技术与技巧
keywords: 
description:
top_img:
comments: true
cover: 工具箱.jpg ##应用于首页的文章标题封面，空白时默认采用主题配置文件中89/92行的参数，可选false
toc: ##目录，默认true
toc_number: true ##目录是否添加序号，配置文件中为false
toc_style_simple:
copyright: false
copyright_author:
copyright_author_href:
copyright_url:
copyright_info:
mathjax:
katex:
aplayer:
highlight_shrink:
aside: true
---
最近看朋友因为打游戏闪退的问题一气之下重装了系统，但是在重装系统的过程又有诸多地方被气到了。我亲身尝试之后发现确实有很多细节需要注意，因此在这里写下自己的安装过程供大家参考，以win7为例。

# 背景/情怀
目前比较盛行的两种使用U盘重装系统的方法分别是`官方iso镜像直接安装`和`微pe工具辅助安装`，前者功能虽然能达到目的，但是功能过于简单（制作启动盘/为磁盘分区），且一旦出现bug很难处理（我就碰到了，我还不会处理）。因此在这里采用后者的方法。
有人提出将操作系统直接安装在U盘之中，这样方便随身携带。但是这样对U盘的传输性能以及容量提出了较大的要求，所以[Windows预安装系统（Windows Preinstallation Environment）](https://baike.baidu.com/item/PE/10854225?fr=aladdin)应运而生，它在原有操作系统的基础上简化了许多内容，使U盘携带的压力减轻了许多。

[`WePE工具箱`](https://www.wepe.com.cn/)是UEPON李培聪在提出`像安装搜狗输入法、QQ那样以安装包的形式安装PE`的想法后产生的作品，v1.0版本由他一人完成。这里贴上UEPON的[知乎](https://www.zhihu.com/people/uepon/answers)。本文也是要利用这位大神开发的工具。

# 所需工具
1. 配置启动盘的另一台台式电脑/笔记本电脑，称为A；
2. 待安装系统的主机/笔记本电脑，称为B；
3. 一个内存在4G以上的空U盘(win10则需要8G，建议直接整个16G一劳永逸)，如果有数据请在其他地方备份好；

# 设备A的部分
## 自行下载需要的windows系统版本
下载地址：https://msdn.itellyou.cn/
该网址为公认的纯净的下载地址，可以在左侧的`操作系统`中选择你需要的版本。
我选择的是“Windows 7 Home Premium with Service Pack 1 (x64) - DVD (Chinese-Simplified)”，点开详细信息里会有一串ed2k:开头的代码，复制后可以用迅雷/各种杂七杂八的下载工具下载，得到的是一个iso文件。这里耗时比较久。

## 下载WePE工具箱并将系统安装进U盘
下载地址：https://www.wepe.com.cn/download.html
请一定一定要从这个官方链接进入，这非常重要！如若因此使安装崩溃或者文件中`夹带私货`，笔者不负责哈哈。
建议选择2.0版本以上的，根据自身情况选择32/64位安装包，下载完成后打开，选择右下角的安装在U盘。
![工具箱界面1](工具箱界面1.jpg)
选择好待写入U盘，就可以开始点击“立即安装”了。
>`注意`：如果U盘需要存放单文件大于4G系统镜像，建议在格式化中选择最优的exFAT格式。
>`注意`：如下操作会格式化U盘，请备份好重要文件同时保证存储空间足够。你可以给U盘卷标设置一个名字，建议全英文。
>笔者的本地软件界面是稍微有些乱码的，但是不影响最终结果，大家如果遇到的话可以放心操作。

![工具箱界面2](工具箱界面2.jpg)
安装完毕后，打开“此电脑”/“我的电脑”，有3种情况：
1. 有两个多出来的盘，一个是空的，命名就是上面自己设的U盘卷标；另一个有一些内容，应该是一些系统的文件。
2. 只有一个多出来的盘，显示的是已经用了一些内容，但是打开之后是空的。
3. 啥也没有，两个原因：一个是没有读取到，那就是接触问题了；另一个是工具箱没有为其分配盘符。
右击“此电脑”，打开“管理"，然后点击"磁盘管理"，可以看到各个分区的情况，然后我们查看U盘是否在其中，如果有，那么就是第二个原因。下图中的Kingston就是我的U盘，但是不像其他盘一样有个(C:)/(D:)。我们右击读取的U盘，点击"更改驱动器号和路径"，点击 “添加”，为其分配一个盘符即可。当然，分配了盘符后，此电脑有可能仍然不显示，那么我们只要在这里直接打开即可，虽然麻烦了一些。
![磁盘管理](磁盘管理.jpg)
最后把前面下载的iso文件放入空的盘里。

# 设备B的部分
## 设置BIOS
在设备B按下开机键后，根据你的机型马上按下BIOS启动快捷键。笔者是微星主板，所以按住F11，注意键盘上有Fn键的可能要同时按下。
![BIOS启动快捷键](BIOS启动快捷键.jpg)
### 保证U盘优先级
一般来说，插入U盘后，设备B会优先识别U盘的内容并执行，但是为了以防万一，这里在bios中设置一下。
橙色区域为读取的优先级，粉色的表示主机已经连接了的设备，建议把蓝框内的USB图标拖到第一个。
建议外接有线鼠标和键盘，可以方便操作。
![BIOS配置1](BIOS配置1.jpg)
### 防止后续装完系统后卡在启动界面
>在安装win7系统时，如果不开启csm兼容模式，则后续安装完系统后会一直卡在"启动windows界面或安装程序正在更新注册表设置"界面，直到安装了win7显卡驱动后才可能进入桌面。安装如果采用uefi模式，默认csm兼容模式是开启不了的（无可选项）；只有当设置为legacy模式，csm兼容模式才可以开启。而2020年后新主板大部分品牌主板不支持legacy模式了，只能在uefi模式下安装win7，所以这里需要我们来调整。

可以在上图的基础上按F7进入高级模式（Advanced Mode），选择`Settings\Security`，将Secure Boot调整为“Disabled”；选择`Settings\Advanced Mode`，将`BIOS UEFI/CSM Mode`调整为`CSM`。按F10保存，右上角X退出后点yes。

## 正式安装系统
把U盘插入设备B，重启机子。加载一段时间文件后会出现如下界面，即WePE工具箱配置而成的PE系统，不得不说还是很干净很舒服的。
![PE系统界面1](PE系统界面1.jpg)
打开桌面上的`CGI备份数据还原`，桌面上没有就点开始/搜索输入。镜像文件刚刚已经放入所谓的D盘了。
![CGI软件界面1](CGI软件界面1.jpg)
点“执行”后，我所下载的2.1版本除下面界面的选项外，还可以选择“不保留相关分区的数据”，如果是重装系统可以不勾。重启的按钮应当勾上。
![CGI软件界面2](CGI软件界面2.jpg)
完成后会黑屏准备开始重启，这个时候就可以拔掉U盘了。（上面设置了U盘优先级，不拔的话重启还是会打开刚才的PE系统）
之后啥也不用干，等待开机完成即可！

# 参考链接：
视频教程，win10的：
https://www.bilibili.com/video/BV1DJ411D79y?p=2&spm_id_from=333.1007.top_right_bar_window_history.content.click

微pe安装指南：
https://www.xitongzongcai.com/win7/50419.html

官方文档——微PE优盘使用说明书：
https://www.wepe.com.cn/ubook/start.html

关于卡在启动画面的解决方法：
http://www.dnxtc.net/zixun/zhuangjijiaocheng/2020-10-12/5879.html

微pe工具箱U盘还原教程：
https://www.somode.com/softjc/13750.html